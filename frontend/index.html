<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Cadastro</title>
</head>
<body>
    <div class="container-principal">

        <h2>Cadastro de Livros</h2>

        <form id="formulario">
                <label for="titulo">Título <input type="text" id="titulo" name="titulo"></label>
                <label for="autor">Autor <input type="text" id="autor" name="autor"></label>
                <label for="ano-publicacao">Ano de Publicação<input type="text" id="ano-publicacao" name="ano-publicacao"></label>
                <label for="genero">Gênero<input type="text" id="genero" name="genero"></label>
                <label for="idioma">Idioma<input type="text" id="idioma" name="idioma"></label>
                <label for="preco">Preço<input type="text" id="preco" name="preco"></label>
                <button type="button" class="botao-cadastro" onclick="enviar()">Cadastrar</button>
                <button type="button" class="botao-lista" onclick="irParaLista()">Ir para Lista de Livros</button>
        </form>

    </div>

    <script>
            function enviar(){
                const formulario = document.getElementById('formulario')

                let inputTitulo = document.getElementById('titulo').value;
                let inputAutor = document.getElementById('autor').value;
                let inputAnoPublicacao = document.getElementById('ano-publicacao').value;
                let inputGenero = document.getElementById('genero').value;
                let inputIdioma = document.getElementById('idioma').value;
                let inputPreco = document.getElementById('preco').value;

                if(!inputTitulo || !inputAutor || !inputAnoPublicacao || !inputGenero || !inputIdioma || !inputPreco){
                    alert("Preencha os campos corretamente!");
                    return;
                }
                

                fetch("http://localhost:3000/livros", {
                    method: "POST",
                    headers: {"Content-type": "application/json"},
                    body: JSON.stringify({
                        titulo: inputTitulo,
                        autor: inputAutor,
                        anoPublicacao: inputAnoPublicacao,
                        genero: inputGenero,
                        idioma: inputIdioma,
                        preco: inputPreco
                    })
                })

                //response (res)
                .then(response => response.json())
                .then(function (data) {
                    alert(`Livro com ID ${data.id} cadastrado`)
                })
                formulario.reset()
            }

            function irParaLista(){
                window.location.href = "livros.html";
            }
    </script>
</body>
</html>